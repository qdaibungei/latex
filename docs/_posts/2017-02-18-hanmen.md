---
layout: post
title: hanmenパッケージ
date: 2017-02-18
---


### 導入
hanmenパッケージというLaTeXパッケージを作った。[ダウンロードはここからできる](https://gist.github.com/qdaibungei/5f6986fa99fc9a7d86122a7a9417d64e)。なお、依存パッケージとして[nombre_for_fancyhdr.sty](http://p-act.sakura.ne.jp/PARALLEL_ACT/LaTeX-Dojin/src/nombre_for_fancyhdr.sty)が必要なのでこちらも併せてダウンロードされたい。

hanmenパッケージとは、版面の設計を厳密に行うためのパッケージである。「版面の設計」というのは、簡単に言えば「本文領域のレイアウト」のことであり、具体的には、「判型」「余白」「組方向」「文字サイズ」「字詰と字間・行間」「段数・段間」を決定することを言う[^1]。

[^1]: 詳しくは<http://t2publisher.xrea.jp/forme/layout.shtml>などを参照せよ。

従来、LaTeXでは版面の設計が煩雑であった。とくに縦組みの場合、geometryパッケージが使えないので厄介である。そこで、縦組みでも版面設計がやりやすいようにと作ったのがhanmenパッケージである。

基本的なアイディアはTomOne氏の『よくわかるLaTeX小説』[^2]による。

[^2]: [よくわかるLaTeX小説サポートページ](http://p-act.sakura.ne.jp/PARALLEL_ACT/LaTeX-Dojin/)は大いに参考になる。

しかし、このパッケージが本当に使えるパッケージなのか、私はよく分かっていない。もしかしたら、geometryパッケージなど、既存のパッケージで同じようなことができるのではないか、という危惧がある。

なお、2017年2月18日現在、あべのり氏によって開発中のクラスファイルである[jlreq.cls](https://github.com/abenori/jlreq)は、従来のクラスファイルより圧倒的に版面設計が行いやすいようになっているようなので、jlreq.clsの安定版がリリースされたあかつきには、hanmenパッケージの存在意義は薄れゆくであろうと思われる。


### 使い方
#### 基本
基本的な使い方は簡単である。プリアンブルに次のように書き込む。

```LaTeX
\usepackage[Q=15,H=24,W=38,L=40]{hanmen}
```

そうすると、

* 文字サイズ　15級
* 行送り　　　24歯
* 行長　　　　38字
* 行数　　　　40行

に設定できる。`Q` は文字サイズの単位「級」に、`H` は行送りの単位「歯」に、`W` はwidthに、`L` はlinesに由来している。

#### 各種オプション
グリッド線を表示させる。

```LaTeX
\usepackage[grid]{hanmen}
```

　

縦組みにする。

```LaTeX
\usepackage[tate]{hanmen}
```

　

ヘッダ・フッタの位置の調整。

```LaTeX
\usepackage[headheight=13truemm,
            headsep=1truemm,
            footskip=3truemm]{hanmen}
```

　

小口寄せ、天寄せ[^ten]。

[^ten]: 天寄せなんていうDTP用語はない気がするが、小口寄せとの類推から勝手に命名した。

```LaTeX
\usepackage[ko=3truemm]{hanmen}%% 3mm小口寄せ
```

```LaTeX
\usepackage[te=4truemm]{hanmen}%% 4mm天寄せ
```

　

文字サイズ単位にQではなくptを使う。

```LaTeX
\usepackage[pt]{hanmen}
```

　

このパッケージは新ドキュメントクラスで使うことを想定している。旧ドキュメントクラスで使う場合、オプションを付けないと、文字サイズが正しく設定されない。

```LaTeX
\usepackage[jisfontzoom]{hanmen}
```

### 提供されるマクロ
#### `\newhanmen`
`\newhanmen` というマクロが提供される。これは、本文中で、

```LaTeX
\newhanmen{Q=11.5,H=19,W=42,L=17}
```

などとすると、文書の途中から基本版面を再設定できるマクロである。上記のオプションはすべてここでも使うことができる。

#### `\hanmenchangedir`
本文領域はそのままに、組方向だけ変えたい場合に使えるのが `\hanmenchangedir` である。本文中、このマクロを記述すると組方向だけが切り替わる。


### 提供される機能
#### 正確な単位の導入
`\bQ` および `\bbp` を導入した。これによって、和文文字に関して、より正確に文字サイズを設定できるようになった。

事情を知らない人には意味が分からないだろうが、LaTeXの文字サイズ単位に関しては複雑な事情があり、そのため上のように新たに単位を導入する必要に迫られるのである。詳しくは、吉永氏による[クラスファイルにおける文字サイズの設定](http://www.h4.dion.ne.jp/~latexcat/column/column1.html)などを参照せよ。

#### フォントサイズの再定義
hanmenパッケージで `\usepackage[Q=13]{hanmen}` のように文字サイズを変更した場合、それに伴って `\small` や `\huge` といったLaTeXに備わった文字サイズ変更マクロが再定義され、文字サイズや行送りサイズが、商業出版で行われているように0.5刻みの数値となる（ただし、現時点では、`Q=10` から `Q=16` までしか再定義されない）。しかしこれは簡易的なものである。したがって、より組版にこだわる人は、一冊の本を作るごとに別途再定義したほうがよいであろう。

#### `tate` オプション時の挙動
hanmenパッケージ読み込み時、`tate` オプションを与えると、自動的にPDFが右綴じになる。また、`\cleardoublepage` が奇数起こしとなるよう再定義される。


### 結尾
他人のアイディアの寄せ集めみたいなパッケージなので、公開が躊躇われる部分もあったが、誰かの役に立つかもしれないので公開した。

最近は、日本語で小説を書く時間よりも、TeX言語でパッケージを書く時間のほうが長くなってしまった。文藝部員としては憂うべき事態である。
