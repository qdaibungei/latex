<!DOCTYPE html>
<html lang="ja">
    <head>
        
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-155017107-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-155017107-1');
        </script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
        <title>hanmenパッケージ｜文藝部LaTeX研究会</title>
        <link rel="stylesheet" href="https://qdaibungei.github.io/latex/css/reset.css" media="screen" title="no title" charset="utf-8">
        <link rel="stylesheet" href="https://qdaibungei.github.io/latex/css/style.css" media="screen" title="no title" charset="utf-8">
        <link rel="stylesheet" href="https://qdaibungei.github.io/latex/css/syntax.css" media="screen" title="no title" charset="utf-8">
        <link rel="shortcut icon" href="favicon.ico">
        <script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
        <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ["\\(","\\)"]] } });</script>
        <script src="https://kit.fontawesome.com/593b5b099a.js" crossorigin="anonymous"></script>
    </head>
    <body>
        <header class="header">
            <div class="header-wrapper">
                <h1 class="logo">
                    <a href="https://qdaibungei.github.io/latex">文藝部L<span class="a">a</span>T<span class="e">e</span>X研究会</a>
                </h1>

<nav class="global-nav">
    <ul>
        <li class="nav-item"><a href="https://qdaibungei.github.io/latex"><i class="fas fa-home"></i> HOME</a></li>
        <li class="nav-item"><a href="https://qdaibungei.github.io/latex/about"><i class="fas fa-info-circle"></i> About</a></li>
        <li class="nav-item active"><a href="https://qdaibungei.github.io/latex/documents"><i class="fas fa-book"></i> Docs</a></li>
    </ul>
</nav>
</div>
</header>
<div class="wrapper clearfix">
<main class="main">
    <div class="content">

<p class="title">
    hanmenパッケージ<br>
</p>


<h1 id="はじめに">はじめに</h1>

<p>hanmenパッケージというLaTeXパッケージを作った。<a href="https://gist.github.com/qdaibungei/5f6986fa99fc9a7d86122a7a9417d64e">ダウンロードはここからできる</a>。</p>

<p>hanmenパッケージとは、版面の設計<sup class="footnote-ref" id="fnref:1"><a href="#fn:1">1</a></sup>を厳密に行うためのパッケージである。たとえば、38字×40行で文書を作りたい、といったときにhanmenパッケージは有用である。</p>

<p>従来、LaTeXでは版面の設計が煩雑であった<sup class="footnote-ref" id="fnref:3"><a href="#fn:3">2</a></sup>。とくに縦組みの場合、geometryパッケージが使えないので厄介である。そこで、縦組みでも版面設計がやりやすいようにと作ったのがhanmenパッケージである。</p>

<p>基本的なアイディアはTomOne氏の『<a href="http://p-act.sakura.ne.jp/PARALLEL_ACT/LaTeX-Dojin/">よくわかるLaTeX小説</a>』による。</p>

<h1 id="使い方">使い方</h1>

<h2 id="基本">基本</h2>

<p>基本的な使い方は簡単である。プリアンブルに次のように書き込む。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[Q=15,H=24,W=38,L=40]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>そうすると、</p>

<ul>
<li>文字サイズ　15級</li>
<li>行送り　　　24歯</li>
<li>行長　　　　38字</li>
<li>行数　　　　40行</li>
</ul>

<p>に設定できる。<code>Q</code> は文字サイズの単位「級」に、<code>H</code> は行送りの単位「歯」に、<code>W</code> はwidthに、<code>L</code> はlinesに由来している。</p>

<h2 id="各種オプション">各種オプション</h2>

<p>グリッド線を表示させる（<code>g</code>に代入する値は上の<code>W</code>で指定した文字数と同じか、または近い整数値を入れる）。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[g=38]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>　</p>

<p>縦組みにする。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[tate]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>　</p>

<p>ヘッダ・フッタの位置の調整。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[headheight=13mm, headsep=1mm, footskip=3mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>　</p>

<p>デフォルトでは、版面は左右中央に配置される。これを、少しだけ小口側に寄せたり、天側に寄せたりしたい場合、以下のようにする。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[ko=3truemm]</span><span class="nb">{</span>hanmen<span class="nb">}</span><span class="err">%%</span> 3mm小口寄せ</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[te=4truemm]</span><span class="nb">{</span>hanmen<span class="nb">}</span><span class="err">%%</span> 4mm天寄せ</code></pre></div>
<p>　</p>

<p>ノド、小口、天、地の広さを直接指定することもできる。なお当然ながら、ノドと小口を両方指定したり、天と地を両方指定したりすることはできない。もし間違えて両方指定した場合はエラーが出るようにしてある。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="c">% ノドと天の広さを指定
</span><span class="c"></span><span class="k">\usepackage</span><span class="na">[nodo=20mm, ten=15mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div><div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="c">% 小口と地の広さを指定
</span><span class="c"></span><span class="k">\usepackage</span><span class="na">[koguchi=20mm, chi=15mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>　</p>

<p>文字サイズ単位にQではなくptを使う。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[pt]</span><span class="nb">{</span>hanmen<span class="nb">}</span>
<span class="err">%</span> <span class="k">\usepackage</span><span class="na">[ptj]</span><span class="nb">{</span>hanmen<span class="nb">}</span> <span class="err">%</span> Wordに合わせたptのサイズにするには ptj とすること。</code></pre></div>
<p>　</p>

<p>このパッケージは新ドキュメントクラス（jsbook.cls、jsarticle.clsなど）で使うことを想定している。旧ドキュメントクラス（jarticle.cls、tbook.clsなど）で使う場合、jisfontzoomオプションを付けないと、文字サイズが正しく設定されない。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[jisfontzoom]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<p>　</p>

<p>版面を一切いじらない。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[pass]</span><span class="nb">{</span>hanmen<span class="nb">}</span></code></pre></div>
<h1 id="提供されるマクロ">提供されるマクロ</h1>

<h2 id="newhanmen"><code>\newhanmen</code></h2>

<p><code>\newhanmen</code> というマクロが提供される。これは、本文中で、</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\newhanmen</span><span class="nb">{</span>Q=11.5,H=19,W=42,L=17<span class="nb">}</span></code></pre></div>
<p>などとすると、文書の途中から基本版面を再設定できるマクロである。上記のオプションはすべてここでも使うことができる。</p>

<p>　</p>

<p>なお、一度代入した値は、<code>\newhanmen</code> においてもそのまま保持される。したがって、</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[Q=13, nodo=20mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span>
<span class="k">\newhanmen</span><span class="nb">{</span>ten=20mm<span class="nb">}</span></code></pre></div>
<p>とした場合、<code>Q=13</code> や <code>nodo=20mm</code> といった値はリセットされず、そのまま使われる。それゆえ、</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[Q=13, nodo=20mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span>
<span class="k">\newhanmen</span><span class="nb">{</span>koguchi=20mm<span class="nb">}</span></code></pre></div>
<p>とするとエラーとなる（ノドと小口を両方同時に指定することはできないため）。このような場合、次のように明示的にノドの広さをリセットしてやる必要がある。</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\usepackage</span><span class="na">[Q=13, nodo=20mm]</span><span class="nb">{</span>hanmen<span class="nb">}</span>
<span class="k">\newhanmen</span><span class="nb">{</span>nodo=<span class="k">\relax</span>, koguchi=20mm<span class="nb">}</span></code></pre></div>
<h2 id="hanmenchangedir"><code>\hanmenchangedir</code></h2>

<p>本文領域はそのままに、組方向だけ変えたい場合に使えるのが <code>\hanmenchangedir</code> である。本文中、このマクロを記述すると組方向だけが切り替わる。</p>

<h2 id="pagegridon"><code>\pagegridon</code></h2>

<p><code>\usepackage[g=50]{hanmen}</code> とやる代わりに、<code>\pagegridon{g=50}</code> としてもグリッド線を表示できる。また、</p>
<div class="highlight"><pre class="chroma"><code class="language-LaTeX" data-lang="LaTeX"><span class="k">\pagegridon</span><span class="nb">{</span>g=26, column=2, columnskip=28.5<span class="nb">}</span></code></pre></div>
<p>とすると、26字×2段組の場合にもうまくグリッド線が表示される。columnskipは、一段の文字数＋段間の広さ。この場合、一段が26字あり、段間の広さが2.5字分あるので、26+2.5=28.5なので、<code>columnskip=28.5</code> としてある（段間の広さをミリメートルで指定できるようにもしたかったが、技術力不足により実現していない）。</p>

<h1 id="提供される機能">提供される機能</h1>

<h2 id="正確な単位の導入">正確な単位の導入</h2>

<p><code>\bQ</code> および <code>\bbp</code> を導入した。これによって、和文文字に関して、より正確に文字サイズを設定できるようになった。</p>

<p>事情を知らない人には意味が分からないだろうが、LaTeXの文字サイズ単位に関しては複雑な事情があり、そのため上のように新たに単位を導入する必要に迫られるのである。詳しくは、吉永氏による<a href="https://web.archive.org/web/20170502030317/http://www.h4.dion.ne.jp/~latexcat/column/column1.html">クラスファイルにおける文字サイズの設定</a>などを参照せよ。</p>

<h2 id="フォントサイズの再定義">フォントサイズの再定義</h2>

<p>hanmenパッケージで <code>\usepackage[Q=13]{hanmen}</code> のように文字サイズを変更した場合、それに伴って <code>\small</code> や <code>\huge</code> といったLaTeXに備わった文字サイズ変更マクロが再定義され、文字サイズや行送りサイズが、0.5刻みの数値となる（ただし、現時点では、<code>Q=10</code> から <code>Q=16</code> までしか再定義されない）。しかしこれは簡易的なものである。したがって、より組版にこだわる人は、一冊の本を作るごとに別途再定義したほうがよいであろう。</p>

<h2 id="tate-オプション時の挙動"><code>tate</code> オプション時の挙動</h2>

<p>hanmenパッケージ読み込み時、<code>tate</code> オプションを与えると、自動的にPDFが右綴じになる。また、<code>\cleardoublepage</code> が奇数起こしとなるよう再定義される。</p>

<h1 id="おわりに">おわりに</h1>

<p>最近は、日本語で小説を書く時間よりも、TeX言語でパッケージを書く時間のほうが長くなってしまった。文藝部員としては憂うべき事態である。</p>

<p>追記：このパッケージを使ってくれている人がいることに近頃気がついた（<a href="https://note.mu/asagiripenguin/n/nbd5cbc19ff15">この方</a>など）。ありがたいことである。</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:1">「版面の設計」とは何かについては、詳しくは「<a href="http://t2publisher.xrea.jp/forme/layout.shtml">基本版面（レイアウト）の設計</a>」（外部サイト）などを参照せよ。
 <a class="footnote-return" href="#fnref:1">↩</a></li>
<li id="fn:3">煩雑と言っても、原理を理解するのはそれほど難しいことではない。<a href="http://d.hatena.ne.jp/Rion778/20091002/1254482262">ここ</a>に書いてあるように設定すればよいだけではある。ただし記述量が多く、プリアンブルに気軽に置いておける感じではない。そこでパッケージ化する必要が出てくるわけである。なお、あべのり氏によって開発中（2017年2月18日現在）のクラスファイルである<a href="https://github.com/abenori/jlreq">jlreq.cls</a>は、従来のクラスファイルより圧倒的に版面設計が行いやすいようになっているようだ。したがってこれを使うというのもよい手であろう。
 <a class="footnote-return" href="#fnref:3">↩</a></li>
</ol>
</div>

<div class="showarticleinfo">
    <i class="fas fa-clock"></i> 2017年2月18日<br>
    <i class="fas fa-redo"></i> 2019年9月2日<br>
    <i class="fas fa-tags"></i>   <code><a href="/latex/tags/latex">#LaTeX</a></code>  <code><a href="/latex/tags/latex%e3%83%91%e3%83%83%e3%82%b1%e3%83%bc%e3%82%b8">#LaTeXパッケージ</a></code> <br>
</div>
                    </div>
                </main>
            </div>
        <footer class="footer">
            <p class="copyright">
                ©2016–2020 文藝部L<span class="a">a</span>T<span class="e">e</span>X研究会
            </p>
        </footer>
    </body>
</html>

